!function(){"use strict";var e=angular.module("IndexModule",["ngAnimate"]);e.controller("IndexCtrl",["$scope","$state","$stateParams","$rootScope","$location","configService","mAlert","timeFunction","toolsBarService","httpService","setPublicMethod","contactsService","skinService",function(e,t,i,o,a,r,l,n,c,s,g,u,v){function S(i){return i?(c.nowPage=1,c.searchText=i,t.go("searchMail",{searchText:e.searchText}),void 0):void l.msg({type:"error",msg:"请输入搜索内容"})}v.initSkin();var h={flag:"leftMenu",scrollEvent:"update"};e.userid=localStorage.userid,e.configService=r,e.bytesToSize=g.bytesToSize,e.toolsBarService=c,e.configService.getBaseSet(),e.configService.getUserData(),u.fetchData(),e.configService.getFolderListData().then(function(){e.toolsBarService.multiMailsShowFlag=e.toolsBarService.multiMailsClickFlag?e.toolsBarService.multiMailsShowFlag:r.mailFolders.multiMails.length&&r.mailFolders.multiMails.length<=3,e.toolsBarService.otherShowFlag=e.toolsBarService.otherClickFlag?e.toolsBarService.otherShowFlag:r.mailFolders.other.length&&r.mailFolders.other.length<=3}),e.multiMailsClick=function(){e.toolsBarService.multiMailsClickFlag=!0,e.toolsBarService.multiMailsShowFlag=!e.toolsBarService.multiMailsShowFlag,setTimeout(function(){e.$emit("scrollbar",h)},100)},e.otherClick=function(){e.toolsBarService.otherClickFlag=!0,e.toolsBarService.otherShowFlag=!e.toolsBarService.otherShowFlag,setTimeout(function(){e.$emit("scrollbar",h)},100)},e.$emit("autoReceive"),e.getLastLogin=n.getLastLogin,e.searchText=c.searchText=i.searchText,e.clickSearch=S,e.keyEnterSearch=function(t){13==t.keyCode&&S(e.searchText)},e.logout=function(){s.index.logout().then(function(t){delete sessionStorage.sessionLogin,delete localStorage.userid,e.$emit("autoReceiveCancel"),location.href="//"+location.host},function(){l.msg({type:"error",msg:"操作失败，请稍后重试！"})})},e.configService.getNotice(function(){var e='<div class="pop-alert-boc"><span>为了提高更安全稳定的邮箱服务，您的搜狐邮箱帐号将于2017年3月1日关闭POP、SMTP、IMAP服务。你可以进入选项--》设置--》邮件服务进行开启设置。请您关注“搜狐邮箱（二维码展现）”，获得最新通知。</span><span class="QRCode"></span></div>';l.alert({title:"提示",body:e,noBtn:!0})}),e.recvMail=function(){r.getMailFlag||(r.getMailFlag=!0,r.sysMailCheckAndReceive()),r.getMultiMailsFlag||(r.getMultiMailsFlag=!0,r.multiMailPopAndReceive())},e.moveupenter=function(e){angular.element(e.target).removeClass("btn-red").addClass("btn-red-enter")},e.moveupleave=function(){angular.element(event.target).removeClass("btn-red-enter").addClass("btn-red")},e.enterpriseHref=function(){window.open("//mail.sohu.net/","_blank")},e.helpHref=function(){var e=a.absUrl().replace(a.path(),"/help");window.open(e,"_blank")},e.$on("$stateChangeStart",function(t,i,o,a,r){var l=i.name.replace(/\.mail/,"");"multiMails"!=l&&"other"!=l?e.configService.nowState=l:e.configService.nowState=o.folderId})}]),e.directive("usedCapacity",function(){return{restrict:"AE",link:function(e,t,i){var o,a=.02,r=.9,l=120,n=setInterval(function(){if(e.configService.quotaSize){o=e.configService.totalSize/Number(e.configService.quotaSize),o=o>a?o:a;var i={width:l*o+"px"};o>r&&(i.background="#FF0000"),t.css(i),clearInterval(n)}},10)}}})}();