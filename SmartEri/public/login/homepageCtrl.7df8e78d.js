!function(e){"use strict";var t=angular.module("IndexModule");t.controller("homepageCtrl",["$scope","configService","mAlert","httpService","timeFunction","setPublicMethod","weather","greetings",function(e,t,i,a,o,n,r,s){e.configService=t,e.configService.getUserData(),e.getLastLogin=o.getLastLogin,e.sendHello=s.getHello(),e.recommend=!0,e.homepageAds=[],e.textAds={};var c;e.showrecommend=function(t){e.recommend=t,c=c||$(".flexslider").eq(1).flexslider({animation:"slide",slideshowSpeed:4e3,touch:!1,directionNav:!1})},e.shopOptions1=[],e.shopOptions2=[],a.index.getScore().then(function(t){0==t.status?t.data.length>0&&(e.shopOptions1.push(t.data[0]),e.shopOptions1.push(t.data[1]),e.shopOptions1.push(t.data[2]),e.shopOptions1.push(t.data[3]),t.data.length>4&&(e.shopOptions2.push(t.data[4]),e.shopOptions2.push(t.data[5]),e.shopOptions2.push(t.data[6]),e.shopOptions2.push(t.data[7]))):i.msg({type:"error",msg:"积分商城返回错误，请稍后再试"})},function(){i.msg({type:"error",msg:"积分商城请求失败，请刷新重试！"})}),a.index.getAd().then(function(t){0===Number(t.status)&&(e.homepageAds=t.data.homepage,e.textAds=t.data.homepageText||{})});var h={type:4};e.showWeather=!1,e.weatherOptions={},e.cityArr=[],e.cityOne={},e.cityTwo={},e.showCity=function(){e.cityOne={showCity:"请选择"},e.cityTwo={showCity:"请选择"},a.index.getCity().then(function(t){e.cityData=t,e.cityArr=n.getCity(t,[]),angular.element(".select-city").show()})},e.hideCity=function(){angular.element(".select-city").hide()};var d=n.getlocalStorage(n.getUserId());d&&(h.cityCode=d),r.getWeather(e,h),e.selectCity=function(t,i){var a=t.showCity;if("string"===(typeof t.value).toLocaleLowerCase())r.getWeather(e,{type:"4",cityCode:t.value});else{if(i)e[r.mapCity[t.city.length]].showCity=t.city[t.city.length-1],e[r.mapCity[t.city.length]].city=t.city.slice(0,t.city.length-1),angular.element("#cityName").find("span").removeClass("hideBorderBottom").addClass("showBorderBottom"),angular.element("#cityName").find("span").eq(t.city.length).removeClass("showBorderBottom").addClass("hideBorderBottom");else if("请选择"!==a&&t.city)if(t.city.length)e[r.mapCity[t.city.length+1]].showCity="请选择",angular.element("#cityName").find("span").eq(t.city.length).removeClass("showBorderBottom").addClass("hideBorderBottom");else{for(var o in r.mapCity)e[r.mapCity[o]].showCity="请选择";angular.element("#cityName").find("span").eq(t.city.length).removeClass("showBorderBottom").addClass("hideBorderBottom")}"请选择"!==a&&(e.cityArr=n.getCity(e.cityData,t.city))}}}]),t.service("weather",["httpService","mAlert","setPublicMethod",function(e,t,i){this.getWeather=function(t,a){var o=this,n="http://mail_wf.cdn.sohusce.com/pc/img/weather/";e.index.getWeather(a).then(function(e){if(200==e.status){i.setlocalStorage({cityCode:e.data.cityCode,userid:i.getUserId()}),angular.element(".select-city").hide();var a=e.data.dayWeather?"day":"night";t.weatherOptions.city=e.data.cityName,t.weatherOptions.temperature=e.data[a+"Temperature"],t.weatherOptions.weather=e.data[a+"Weather"],t.weatherOptions.windDirect=e.data[a+"WindDirect"],t.weatherOptions.windPower=e.data[a+"WindPower"],t.weatherOptions.src=n+a+"/"+o.weatherImage[e.data[a+"Weather"]]+".png",t.showWeather=!0}else t.showWeather=!1})},this.weatherImage={"晴":"00","多云":"01","阴":"02","阵雨":"03","雷阵雨":"04","雷阵雨伴有冰雹":"05","雨夹雪":"06","小雨":"07","中雨":"08","大雨":"09","暴雨":"10","大暴雨":"11","特大暴雨":"12","阵雪":"13","小雪":"14","中雪":"15","大雪":"16","暴雪":"17","雾":"18","冻雨":"19","沙尘暴":"20","小到中雨":"21","中到大雨":"22","大到暴雨":"23","暴雨到大暴雨":"24","大暴雨到特大暴雨":"25","小到中雪":"26","中到大雪":"27","大到暴雪":"28","浮尘":"29","扬沙":"30","强沙尘暴":"31","霾":"53","无":"99"},this.mapCity={1:"cityOne",2:"cityTwo"}}]),t.factory("greetings",["timeFunction",function(e){function t(e,t){var i=t-e+1;return Math.floor(Math.random()*i+e)}function i(){var e=t(0,a.length-1);return a[e]}var a=["做最真实的自己","做个好人，简单可依赖","热爱生活，让日常，不寻常","愿你被世界温柔相待","人生是场修行，见天地，见自己","包容并静默，不问不怨，不哀伤","不乱于心，不困于情，不念过往，不畏将来","希望你对过往一切情深义重但从不回头","真正的勇敢，不是没有弱点，而是带着恐惧前行","你简单，这世界就简单","一辈子做对与做错的事，会不会刚好一样多","我们都要尽量靠近光亮，让心情温暖","任时光匆匆流去，我只在乎你","把美好事物纯真走完，沿途你不枉为少年","不负美食不负心","食物有很强的治愈力量","如果你不出去走走，你会以为这就是世界","不要走得太快，灵魂都跟不上了","大声地笑出声来，就不再害怕了","到不了的地方叫做远方，回不去的世界叫做家乡","我们把世界看错了，反说它欺骗我们","群星不怕显得像萤火那样","若能避开猛烈的狂喜，自然不会有悲矜来袭","雨窗和泪摇湘管，意长笺短","东风不管琵琶怨，落花吹遍","人面不知何处，绿波依旧东流","We are 伐木累"];return{getHello:i}}]),t.directive("adImage",function(){return{restrict:"AE",link:function(e,t,i){if(!e.adFlexslider)var a=0,o=setInterval(function(){a++,t.find(".slides > li").length&&(t.flexslider({animation:"slide",slideshowSpeed:4e3,touch:!1,directionNav:!1}),clearInterval(o))},10)}}}),t.directive("adScore",function(){return{restrict:"AE",link:function(e,t,i){var a=setInterval(function(){e.shopOptions1.length&&(t.flexslider({animation:"slide",slideshowSpeed:1e4,touch:!1,directionNav:!1}),clearInterval(a))},10)}}})}($);